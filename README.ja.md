# Gemini TTS 比較デモ

このプロジェクトは、Google Cloudサービスを使用して日本語のテキスト読み上げ（TTS）を生成するための様々な手法を実証するものです。以下の4つの異なるアプローチを比較します。

1.  **デフォルト:** 特別なチューニングなしの基本的なTTS。
2.  **手動チューニング:** 発話速度とピッチに全体的な調整を加えたTTS。
3.  **ルールベースの自動タギング:** 句読点に基づいて自動的にSSMLタグを追加するシンプルなスクリプト。
4.  **AIによるチューニング:** Vertex AI経由でGeminiモデルを使用し、テキストをインテリジェントに分析して、より自然で人間らしい話し方のための繊細なSSMLタグを挿入します。

プロセス全体は、単一のGoogle Cloud IAMサービスアカウントを使用して安全に認証されます。

## 前提条件

始める前に、以下のものがインストールされていることを確認してください：
- Python (~3.12)
- [Poetry](https://python-poetry.org/docs/#installation) （依存関係管理用）
- [Google Cloud SDK](https://cloud.google.com/sdk/docs/install) （任意ですが、デバッグに役立ちます）

## セットアップ手順

プロジェクトをセットアップし、MP3生成を再現するには、以下の手順に従ってください。

### 1. リポジトリをクローンする

このリポジトリをローカルマシンにクローンします：
```bash
git clone <repository-url>
cd <repository-directory>
```

### 2. Google Cloud プロジェクトのセットアップ

このプロジェクトには、いくつかのサービスが有効化されたGoogle Cloudプロジェクトが必要です。

**A. プロジェクトの作成または選択**
- [Google Cloud Console](https://console.cloud.google.com/)にアクセスし、既存のプロジェクトを選択するか、新しいプロジェクトを作成します。

**B. 課金を有効にする**
- Vertex AI APIを使用するには、プロジェクトが有効な課金アカウントにリンクされている必要があります。
- コンソールの**「課金」**セクションに移動し、プロジェクトが課金アカウントに関連付けられていることを確認してください。新規ユーザーはクレジット付きの無料トライアルの対象となる場合があります。

**C. 必要なAPIを有効にする**
- このプロジェクトでは2つのAPIを有効にする必要があります。以下のリンクをクリックし、それぞれで「有効にする」をクリックしてください：
    1.  [Cloud Text-to-Speech API](https://console.cloud.google.com/apis/library/texttospeech.googleapis.com)
    2.  [Vertex AI API](https://console.cloud.google.com/apis/library/aiplatform.googleapis.com)

**D. サービスアカウントの作成**
- スクリプトの安全な認証のためにサービスアカウントを使用します。
    1.  Google Cloud Consoleで、**IAMと管理 > サービスアカウント**に移動します。
    2.  **+ サービスアカウントを作成**をクリックします。
    3.  名前を付けます（例：`gemini-tts-demo-user`）。
    4.  **作成して続行**をクリックします。
    5.  「このサービスアカウントにプロジェクトへのアクセスを許可する」のステップで、**Vertex AI ユーザー**のロールを追加します。この単一のロールで、TTSとGeminiモデルの両方に必要なすべての権限が付与されます。
    6.  **完了**をクリックします。

**E. サービスアカウントキーのダウンロード**
    1.  リストから先ほど作成したサービスアカウントを見つけます。
    2.  「操作」列にある3つのドットのメニューをクリックし、**鍵を管理**を選択します。
    3.  **鍵を追加 > 新しい鍵を作成**をクリックします。
    4.  キータイプとして**JSON**を選択し、**作成**をクリックします。JSONファイルがダウンロードされます。
    5.  このファイルをプロジェクトのルートディレクトリに移動し、`iam-key.json`にリネームします。

**重要:** `.gitignore`ファイルは`iam-key.json`を無視するように設定されています。**このファイルをソース管理にコミットしないでください。**

### 3. 依存関係のインストール

Poetryがインストールされている状態で、プロジェクトのルートで以下のコマンドを実行し、仮想環境を作成して必要なライブラリをすべてインストールします：

```bash
poetry install
```

## スクリプトの実行

4つの比較用MP3ファイルを生成するには、Poetryを使用してメインスクリプトを実行します：

```bash
poetry run python tts_comparison.py
```

スクリプトが実行され、進行状況が出力されます。完了すると、プロジェクトディレクトリに以下の4つのファイルが生成されます：

- `news_1_default.mp3`
- `news_2_manual_tuned.mp3`
- `news_3_auto_tagged.mp3`
- `news_4_ai_tuned.mp3`
